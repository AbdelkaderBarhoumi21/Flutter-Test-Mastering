name: Flutter â€“ AndroidBuild Dev

on:
    push:
        branches:
            - main-1
    pull_request:
        branches:
            - main-1
jobs:
    build:
        runs-on: macos-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
            #   - name: Setup JDK
            #     uses: actions/setup-java@v4
            #     with:
            #       java-version: "17"
            #       distribution: "zulu" # no need for java for IOS
            - name: Setup BASE_URL File
              run: echo "${{ secrets.BASE_URL_FILE }}" | base64 --decode > lib/core/data/local/remote/token/base_url.dart

            - name: Setup Flutter
              uses: subosito/flutter-action@v2
              with:
                  channel: "stable"

            - name: Install dependencies
              run: flutter pub get
            - name: Auto Format the card code
              run: dart format .
            - name: Verify the dart code is formatted
              run: dart format --output=none --set-exit-if-changed .
            - name: Run test
              run: flutter test
            - name: Analyse the dart code
              run: flutter analyze --fatal-warnings
            - name: Install IOS dependencies
              run: |
                  cd ios 
                  pod install --repo-update
                  cd ..
            - name: Build ios
              run: flutter build ios --debug --build-name=1.0.0 --build-number=1 --no-codesign
